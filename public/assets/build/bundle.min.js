/* optimized.js */const APP_CONFIG={apiBase:'/api',csrfToken:document.querySelector('meta[name="csrf-token"]')?.getAttribute('content'),debug:false};const Utils={showToast:function(type,message,duration=5000){const toastContainer=document.querySelector('.toast-container')||document.createElement('div');if(!document.querySelector('.toast-container')){toastContainer.className='toast-container';document.body.appendChild(toastContainer)}const toast=document.createElement('div');toast.className=`toast show bg-${type} text-white`;toast.innerHTML=`<div class="toast-body">${message}<button type="button" class="btn-close btn-close-white ms-auto" data-bs-dismiss="toast"></button></div>`;toastContainer.appendChild(toast);setTimeout(()=>{if(toast.parentNode){toast.remove()}},duration);return toast},clearSearch:function(inputId){const input=document.getElementById(inputId);if(input){input.value='';input.form?.submit()}},formatCurrency:function(amount,currency='USD'){return new Intl.NumberFormat('en-US',{style:'currency',currency:currency}).format(amount)},formatDate:function(dateString){return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'})},getStatusColor:function(status){const statusMap={'active':'success','maintenance':'warning','offline':'danger','pending':'secondary'};return statusMap[status?.toLowerCase()]||'secondary'},debounce:function(func,wait){let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}},showLoading:function(element,text='Loading...'){if(element){element.innerHTML=`<div class="text-center p-3"><div class="spinner-border text-primary"></div><p class="mt-2">${text}</p></div>`}},hideLoading:function(element){if(element&&element.querySelector('.spinner-border')){element.innerHTML=''}}};const API={request:async function(url,options={}){const defaultOptions={headers:{'Content-Type':'application/json','X-Requested-With':'XMLHttpRequest'}};if(APP_CONFIG.csrfToken){defaultOptions.headers['X-CSRF-TOKEN']=APP_CONFIG.csrfToken}const finalOptions={...defaultOptions,...options,headers:{...defaultOptions.headers,...options.headers}};try{const response=await fetch(url,finalOptions);if(!response.ok){throw new Error(`HTTP error! Status: ${response.status}`)}const contentType=response.headers.get('content-type');if(contentType&&contentType.includes('application/json')){return await response.json()}else{return await response.text()}}catch(error){console.error('API request failed:',error);throw error}},get:function(url,params={}){const queryString=new URLSearchParams(params).toString();const fullUrl=queryString?`${url}?${queryString}`:url;return this.request(fullUrl)},post:function(url,data={}){return this.request(url,{method:'POST',body:JSON.stringify(data)})},put:function(url,data={}){return this.request(url,{method:'PUT',body:JSON.stringify(data)})},delete:function(url){return this.request(url,{method:'DELETE'})}};const FormHandler={validateRequired:function(form,fields){const errors=[];fields.forEach(field=>{const element=form.querySelector(`[name="${field}"]`);if(!element||!element.value.trim()){errors.push(`${field.replace('_',' ')} is required`)}});return errors},submitAjax:async function(form,successCallback,errorCallback){const formData=new FormData(form);const data=Object.fromEntries(formData.entries());try{const response=await API.post(form.action,data);if(successCallback)successCallback(response)}catch(error){if(errorCallback)errorCallback(error);else Utils.showToast('danger',error.message)}},reset:function(form){form.reset();form.querySelectorAll('.is-invalid').forEach(el=>{el.classList.remove('is-invalid')})}};const TableHandler={initSortable:function(tableSelector){const tables=document.querySelectorAll(tableSelector);tables.forEach(table=>{const headers=table.querySelectorAll('th[data-sort]');headers.forEach(header=>{header.style.cursor='pointer';header.addEventListener('click',()=>{this.sortTable(table,header.dataset.sort)})})})},sortTable:function(table,column){const tbody=table.querySelector('tbody');const rows=Array.from(tbody.querySelectorAll('tr'));const currentOrder=table.dataset.sortOrder||'asc';const newOrder=currentOrder==='asc'?'desc':'asc';rows.sort((a,b)=>{const aValue=a.querySelector(`td[data-${column}]`)?.dataset[column]||'';const bValue=b.querySelector(`td[data-${column}]`)?.dataset[column]||'';if(newOrder==='asc'){return aValue.localeCompare(bValue)}else{return bValue.localeCompare(aValue)}});rows.forEach(row=>tbody.appendChild(row));table.dataset.sortOrder=newOrder},updateTable:function(tableSelector,data,rowTemplate){const table=document.querySelector(tableSelector);if(!table)return;const tbody=table.querySelector('tbody');tbody.innerHTML='';if(data.length===0){tbody.innerHTML='<tr><td colspan="100%" class="text-center">No data found</td></tr>';return}data.forEach(item=>{const row=document.createElement('tr');row.innerHTML=rowTemplate(item);tbody.appendChild(row)})}};const ModalHandler={show:function(modalId,title,content){const modal=document.getElementById(modalId);if(!modal)return;const titleEl=modal.querySelector('.modal-title');const bodyEl=modal.querySelector('.modal-body');if(titleEl)titleEl.textContent=title;if(bodyEl)bodyEl.innerHTML=content;const bootstrapModal=new bootstrap.Modal(modal);bootstrapModal.show()},hide:function(modalId){const modal=document.getElementById(modalId);if(modal){const bootstrapModal=bootstrap.Modal.getInstance(modal);if(bootstrapModal)bootstrapModal.hide()}},confirm:function(message,onConfirm,onCancel){const modal=document.getElementById('confirmModal')||this.createConfirmModal();const bodyEl=modal.querySelector('.modal-body');bodyEl.textContent=message;const confirmBtn=modal.querySelector('.btn-confirm');const cancelBtn=modal.querySelector('.btn-cancel');const newConfirmBtn=confirmBtn.cloneNode(true);const newCancelBtn=cancelBtn.cloneNode(true);confirmBtn.parentNode.replaceChild(newConfirmBtn,confirmBtn);cancelBtn.parentNode.replaceChild(newCancelBtn,cancelBtn);newConfirmBtn.addEventListener('click',()=>{this.hide('confirmModal');if(onConfirm)onConfirm()});newCancelBtn.addEventListener('click',()=>{this.hide('confirmModal');if(onCancel)onCancel()});this.show('confirmModal','Confirm Action','')},createConfirmModal:function(){const modal=document.createElement('div');modal.className='modal fade';modal.id='confirmModal';modal.innerHTML=`<div class="modal-dialog"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Confirm Action</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"></div><div class="modal-footer"><button type="button" class="btn btn-secondary btn-cancel">Cancel</button><button type="button" class="btn btn-primary btn-confirm">Confirm</button></div></div></div>`;document.body.appendChild(modal);return modal}};document.addEventListener('DOMContentLoaded',function(){const searchInputs=document.querySelectorAll('input[type="search"], input[name="search"]');searchInputs.forEach(input=>{const debouncedSearch=Utils.debounce(()=>{if(input.form)input.form.submit()},500);input.addEventListener('input',debouncedSearch)});TableHandler.initSortable('table[data-sortable="true"]');const tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));tooltipTriggerList.map(function(tooltipTriggerEl){return new bootstrap.Tooltip(tooltipTriggerEl)});const popoverTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));popoverTriggerList.map(function(popoverTriggerEl){return new bootstrap.Popover(popoverTriggerEl)});const toasts=document.querySelectorAll('.toast');toasts.forEach(toast=>{setTimeout(()=>{if(toast.parentNode){toast.remove()}},5000)})});window.Utils=Utils;window.API=API;window.FormHandler=FormHandler;window.TableHandler=TableHandler;window.ModalHandler=ModalHandler;/* main.js */document.addEventListener('DOMContentLoaded',function(){const sidebarToggle=document.getElementById('sidebarToggle');const sidebar=document.querySelector('.sidebar');if(sidebarToggle&&sidebar){sidebarToggle.addEventListener('click',function(){sidebar.classList.toggle('show')})}const tooltips=document.querySelectorAll('[data-bs-toggle="tooltip"]');tooltips.forEach(tooltip=>{new bootstrap.Tooltip(tooltip)});const popovers=document.querySelectorAll('[data-bs-toggle="popover"]');popovers.forEach(popover=>{new bootstrap.Popover(popover)});const alerts=document.querySelectorAll('.alert-dismissible');alerts.forEach(alert=>{const closeBtn=alert.querySelector('.btn-close');if(closeBtn){closeBtn.addEventListener('click',function(){alert.remove()})}});const forms=document.querySelectorAll('form[data-ajax="true"]');forms.forEach(form=>{form.addEventListener('submit',function(e){e.preventDefault();const formData=new FormData(form);fetch(form.action,{method:form.method,body:formData}).then(response=>response.json()).then(data=>{if(data.success){Utils.showToast('success',data.message);if(data.redirect){window.location.href=data.redirect}}else{Utils.showToast('danger',data.message)}}).catch(error=>{Utils.showToast('danger','An error occurred')})})})});/* dashboard.js */document.addEventListener('DOMContentLoaded',function(){const ctx=document.getElementById('revenueChart');if(ctx){new Chart(ctx,{type:'line',data:{labels:['Jan','Feb','Mar','Apr','May','Jun'],datasets:[{label:'Revenue',data:[12000,19000,15000,25000,22000,30000],borderColor:'rgb(75,192,192)',backgroundColor:'rgba(75,192,192,0.2)',tension:0.1}]},options:{responsive:true,scales:{y:{beginAtZero:true}}}})}const statusChart=document.getElementById('statusChart');if(statusChart){new Chart(statusChart,{type:'doughnut',data:{labels:['Active','Inactive','Pending'],datasets:[{data:[65,20,15],backgroundColor:['#28a745','#dc3545','#ffc107']}]},options:{responsive:true,plugins:{legend:{position:'bottom'}}}})}const searchInput=document.getElementById('searchInput');if(searchInput){const debouncedSearch=Utils.debounce(function(){const searchTerm=this.value;if(searchTerm.length>=2||searchTerm.length===0){fetch(`/api/search?q=${encodeURIComponent(searchTerm)}`).then(response=>response.json()).then(data=>{updateSearchResults(data.results)})}},300);searchInput.addEventListener('input',debouncedSearch)}function updateSearchResults(results){const resultsContainer=document.getElementById('searchResults');if(resultsContainer){resultsContainer.innerHTML='';results.forEach(result=>{const resultElement=document.createElement('div');resultElement.className='search-result-item';resultElement.innerHTML=`<h6>${result.title}</h6><p>${result.description}</p>`;resultElement.addEventListener('click',()=>{window.location.href=result.url});resultsContainer.appendChild(resultElement)})}}const refreshBtn=document.getElementById('refreshData');if(refreshBtn){refreshBtn.addEventListener('click',function(){this.disabled=true;this.innerHTML='<i class="fas fa-spinner fa-spin"></i> Refreshing...';fetch('/api/dashboard/stats').then(response=>response.json()).then(data=>{updateDashboardStats(data);this.disabled=false;this.innerHTML='<i class="fas fa-sync-alt"></i> Refresh'})})}function updateDashboardStats(stats){Object.keys(stats).forEach(key=>{const element=document.getElementById(`stat-${key}`);if(element){element.textContent=stats[key]}})}});/* sidebar.js */document.addEventListener('DOMContentLoaded',function(){const sidebar=document.querySelector('.sidebar');const sidebarToggle=document.getElementById('sidebarToggle');const overlay=document.createElement('div');overlay.className='sidebar-overlay';overlay.style.cssText='position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:999;display:none';document.body.appendChild(overlay);if(sidebarToggle){sidebarToggle.addEventListener('click',function(){sidebar.classList.toggle('show');overlay.style.display=sidebar.classList.contains('show')?'block':'none'})}overlay.addEventListener('click',function(){sidebar.classList.remove('show');overlay.style.display='none'})document.addEventListener('keydown',function(e){if(e.key==='Escape'&&sidebar.classList.contains('show')){sidebar.classList.remove('show');overlay.style.display='none'}});const sidebarLinks=document.querySelectorAll('.sidebar-nav a');sidebarLinks.forEach(link=>{if(link.href===window.location.href){link.classList.add('active')}link.addEventListener('click',function(){sidebarLinks.forEach(l=>l.classList.remove('active'));this.classList.add('active')})});const submenuToggles=document.querySelectorAll('.sidebar-nav .has-submenu');submenuToggles.forEach(toggle=>{const submenu=toggle.querySelector('.submenu');if(submenu){toggle.addEventListener('click',function(e){e.preventDefault();submenu.style.display=submenu.style.display==='block'?'none':'block';this.classList.toggle('expanded')})}});const sidebarScroll=document.querySelector('.sidebar-nav');if(sidebarScroll){let isScrolling=false;sidebarScroll.addEventListener('scroll',function(){if(!isScrolling){isScrolling=true;setTimeout(()=>{isScrolling=false},150)}})}const sidebarResize=function(){if(window.innerWidth<=768){sidebar.classList.remove('show');overlay.style.display='none'}};window.addEventListener('resize',sidebarResize);sidebarResize()});